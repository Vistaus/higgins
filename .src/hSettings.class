' Gambas class file

Public Sub Button1_Click()
  Try FMain.xb.close()
  FMain.setup_xbindkeys()
  If FMain.xb.init_error Then
    Try FMain.setup_xbindkeys()
    If FMain.xb.init_error Then 
      FMain.xb_show_init_error(True)
      Return
    Endif
  Endif
  Me.mouse = Mouse.wait
  Wait 0.1
  Me.enabled = False
  Wait
  Message.Info("A blank window will open shortly,\nPlease press the desidered shortcut there.")
  FMain.xb.clear_hotkeys()
  FMain.xb.register("show")
  Me.enabled = True
  Me.mouse = Mouse.normal
  ShowShortcut()
End

Public Sub Form_Hide()
  MySettings.save()
  FMain.Show()
End

Public Sub ComboboxTerminalEmulator_Change()
  Settings["terminal_emulator"] = ComboboxTerminalEmulator.text
  Settings.Save()
End

Public Sub Panel1_Arrange()
  ShowShortcut()
End

Private Sub ShowShortcut()

  Dim s As String[]

  hSettings.button1.text = ("Change")
  Try s = Split(File.Load(FMain.xb_rcpath), "\n", "", True)
  If Error Then Return

  hSettings.button1.text = s[s.max]

  'hSettings.button1.AutoResize = True
  
End
